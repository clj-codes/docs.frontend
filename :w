(ns codes.clj.docs.frontend.components.query
  (:require ["@mantine/core" :refer [Alert Grid Group LoadingOverlay SimpleGrid
                                     Text Title Indicator Avatar Anchor]]
            ["@tabler/icons-react" :refer [IconInfoCircle]]
            [codes.clj.docs.frontend.infra.helix :refer [defnc]]
            [helix.core :refer [$]]))

(defnc latest-interactions [{:keys [value loading? error]}]
  ($ SimpleGrid {:cols 1}
    ($ Title {:order 1} "Recently Updated")

    (if error
      ($ Alert {:variant "light" :color "red" :radius "md" :title "Error" :icon ($ IconInfoCircle)}
        (str error))

      ($ Group {:pos "relative"}
        ($ LoadingOverlay {:visible loading? :zIndex 1000 :overlayProps #js {:radius "sm" :blur 2}})
        ($ SimpleGrid {:cols 2}
          ($ Text "Top Authors"))))))

(defnc top-author [{:keys [value loading? error]}]
  ($ SimpleGrid {:cols 1}
    ($ Title {:order 1} "Top Authors")

    (if error
      ($ Alert {:variant "light" :color "red" :radius "md" :title "Error" :icon ($ IconInfoCircle)}
        (str error))

      ($ Group {:pos "relative"}
        ($ LoadingOverlay {:visible loading? :zIndex 1000 :overlayProps #js {:radius "sm" :blur 2}})
        ($ Grid {:grow false :gutter "md"}
          (map
            (fn [{:keys [author-id login account-source interactions avatar-url]}]
              ($ (.-Col Grid) {:key (str "avatar" author-id)
                               :span 2}
                ($ Indicator {:inline true :label interactions :size 16}
                  ($ Anchor {:href (str "/author/" login "/" account-source)}
                    ($ Avatar {:size "md" :src avatar-url})))))
            value))))))

; <Indicator inline label="New" size={16}>
    ;   <Avatar
    ;     size="lg"
    ;     radius="sm"
    ;     src="https://raw.githubusercontent.com/mantinedev/mantine/master/.demo/avatars/avatar-2.png"
    ;   />
    ; </Indicator>
